---
import AdminLayout from '../../../layouts/roles/AdminLayout.astro';
---

<AdminLayout title="Configuración">
  <div class="configuracion-page">
    <!-- Header -->
    <div class="page-header">
      <div class="header-info">
        <h1 class="page-title">Configuración del Sistema</h1>
        <p class="page-description">Ajustes generales y preferencias de la plataforma</p>
      </div>
    </div>

    <!-- Tabs de configuración -->
    <div class="config-tabs">
      <button class="tab-btn active" data-tab="general">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
        General
      </button>
      <button class="tab-btn" data-tab="notificaciones">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
        </svg>
        Notificaciones
      </button>
      <button class="tab-btn" data-tab="alertas">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
          <line x1="12" y1="9" x2="12" y2="13"/>
          <line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
        Alertas
      </button>
      <button class="tab-btn" data-tab="integraciones">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
          <polyline points="15 3 21 3 21 9"/>
          <line x1="10" y1="14" x2="21" y2="3"/>
        </svg>
        Integraciones
      </button>
      <button class="tab-btn" data-tab="seguridad">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
        </svg>
        Seguridad
      </button>
    </div>

    <!-- Contenido de configuración -->
    <div class="config-content">
      <!-- Sección General -->
      <section class="config-section" id="tab-general">
        <div class="section-card">
          <h3 class="section-title">Información de la Empresa</h3>
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Nombre de la empresa</label>
              <input type="text" class="form-input" value="Llanogas S.A. E.S.P." />
            </div>
            <div class="form-group">
              <label class="form-label">NIT</label>
              <input type="text" class="form-input" value="900.123.456-7" />
            </div>
            <div class="form-group">
              <label class="form-label">Dirección</label>
              <input type="text" class="form-input" value="Calle 100 #15-50, Bogotá" />
            </div>
            <div class="form-group">
              <label class="form-label">Teléfono</label>
              <input type="text" class="form-input" value="+57 (1) 234 5678" />
            </div>
            <div class="form-group full-width">
              <label class="form-label">Email de contacto</label>
              <input type="email" class="form-input" value="contacto@llanogas.com" />
            </div>
          </div>
        </div>

        <div class="section-card">
          <h3 class="section-title">Preferencias del Sistema</h3>
          <div class="settings-list">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Zona horaria</span>
                <span class="setting-description">Configura la zona horaria predeterminada del sistema</span>
              </div>
              <select class="form-select">
                <option value="america_bogota" selected>América/Bogotá (UTC-5)</option>
                <option value="utc">UTC</option>
              </select>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Formato de fecha</span>
                <span class="setting-description">Define cómo se muestran las fechas en la plataforma</span>
              </div>
              <select class="form-select">
                <option value="dd_mm_yyyy" selected>DD/MM/YYYY</option>
                <option value="mm_dd_yyyy">MM/DD/YYYY</option>
                <option value="yyyy_mm_dd">YYYY-MM-DD</option>
              </select>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Idioma del sistema</span>
                <span class="setting-description">Idioma predeterminado para todos los usuarios</span>
              </div>
              <select class="form-select">
                <option value="es" selected>Español</option>
                <option value="en">English</option>
              </select>
            </div>
          </div>
        </div>
      </section>

      <!-- Sección Notificaciones -->
      <section class="config-section hidden" id="tab-notificaciones">
        <div class="section-card">
          <h3 class="section-title">Canales de Notificación</h3>
          <div class="settings-list">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Notificaciones por email</span>
                <span class="setting-description">Enviar alertas y recordatorios por correo electrónico</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Notificaciones en plataforma</span>
                <span class="setting-description">Mostrar notificaciones dentro de la aplicación</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Notificaciones SMS</span>
                <span class="setting-description">Enviar alertas críticas por mensaje de texto</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" />
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="section-card">
          <h3 class="section-title">Configuración de Email</h3>
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Servidor SMTP</label>
              <input type="text" class="form-input" value="smtp.llanogas.com" />
            </div>
            <div class="form-group">
              <label class="form-label">Puerto</label>
              <input type="text" class="form-input" value="587" />
            </div>
            <div class="form-group">
              <label class="form-label">Usuario SMTP</label>
              <input type="text" class="form-input" value="notificaciones@llanogas.com" />
            </div>
            <div class="form-group">
              <label class="form-label">Contraseña</label>
              <input type="password" class="form-input" value="********" />
            </div>
          </div>
          <button class="btn-secondary mt-4">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            Probar conexión
          </button>
        </div>
      </section>

      <!-- Sección Alertas -->
      <section class="config-section hidden" id="tab-alertas">
        <div class="section-card">
          <h3 class="section-title">Recordatorios de Vencimiento</h3>
          <div class="settings-list">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Primera alerta</span>
                <span class="setting-description">Días antes del vencimiento para la primera alerta</span>
              </div>
              <div class="input-with-suffix">
                <input type="number" class="form-input small" value="7" />
                <span class="suffix">días</span>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Segunda alerta</span>
                <span class="setting-description">Días antes del vencimiento para recordatorio urgente</span>
              </div>
              <div class="input-with-suffix">
                <input type="number" class="form-input small" value="3" />
                <span class="suffix">días</span>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Alerta crítica</span>
                <span class="setting-description">Días antes del vencimiento para alerta crítica</span>
              </div>
              <div class="input-with-suffix">
                <input type="number" class="form-input small" value="1" />
                <span class="suffix">días</span>
              </div>
            </div>
          </div>
        </div>

        <div class="section-card">
          <h3 class="section-title">Notificar a</h3>
          <div class="settings-list">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Responsable del reporte</span>
                <span class="setting-description">Enviar alertas al usuario asignado al reporte</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Supervisor</span>
                <span class="setting-description">Incluir al supervisor en alertas importantes</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Administradores</span>
                <span class="setting-description">Notificar a admins en alertas críticas</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>
      </section>

      <!-- Sección Integraciones -->
      <section class="config-section hidden" id="tab-integraciones">
        <div class="section-card">
          <h3 class="section-title">Integraciones Activas</h3>
          <div class="integrations-grid">
            <div class="integration-card active">
              <div class="integration-logo">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
              </div>
              <div class="integration-info">
                <h4 class="integration-name">Email SMTP</h4>
                <span class="integration-status connected">Conectado</span>
              </div>
              <button class="btn-link">Configurar</button>
            </div>

            <div class="integration-card">
              <div class="integration-logo">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                </svg>
              </div>
              <div class="integration-info">
                <h4 class="integration-name">API Entidades</h4>
                <span class="integration-status pending">Sin configurar</span>
              </div>
              <button class="btn-link">Configurar</button>
            </div>

            <div class="integration-card active">
              <div class="integration-logo">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                </svg>
              </div>
              <div class="integration-info">
                <h4 class="integration-name">Almacenamiento</h4>
                <span class="integration-status connected">AWS S3</span>
              </div>
              <button class="btn-link">Configurar</button>
            </div>

            <div class="integration-card">
              <div class="integration-logo">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/>
                  <line x1="12" y1="18" x2="12.01" y2="18"/>
                </svg>
              </div>
              <div class="integration-info">
                <h4 class="integration-name">SMS Gateway</h4>
                <span class="integration-status pending">Sin configurar</span>
              </div>
              <button class="btn-link">Configurar</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Sección Seguridad -->
      <section class="config-section hidden" id="tab-seguridad">
        <div class="section-card">
          <h3 class="section-title">Políticas de Contraseñas</h3>
          <div class="settings-list">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Longitud mínima</span>
                <span class="setting-description">Número mínimo de caracteres requeridos</span>
              </div>
              <div class="input-with-suffix">
                <input type="number" class="form-input small" value="8" min="6" max="32" />
                <span class="suffix">caracteres</span>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Requerir mayúsculas</span>
                <span class="setting-description">La contraseña debe incluir letras mayúsculas</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Requerir números</span>
                <span class="setting-description">La contraseña debe incluir al menos un número</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Requerir caracteres especiales</span>
                <span class="setting-description">Incluir símbolos como @, #, $, etc.</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" />
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="section-card">
          <h3 class="section-title">Sesiones y Acceso</h3>
          <div class="settings-list">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Expiración de sesión</span>
                <span class="setting-description">Tiempo de inactividad antes de cerrar sesión automáticamente</span>
              </div>
              <div class="input-with-suffix">
                <input type="number" class="form-input small" value="60" />
                <span class="suffix">minutos</span>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Intentos de login fallidos</span>
                <span class="setting-description">Bloquear cuenta después de intentos fallidos</span>
              </div>
              <div class="input-with-suffix">
                <input type="number" class="form-input small" value="5" />
                <span class="suffix">intentos</span>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-name">Autenticación de dos factores</span>
                <span class="setting-description">Requerir 2FA para administradores</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" />
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Footer con botones -->
    <div class="config-footer">
      <button class="btn-secondary">Cancelar cambios</button>
      <button class="btn-primary">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
          <polyline points="17 21 17 13 7 13 7 21"/>
          <polyline points="7 3 7 8 15 8"/>
        </svg>
        Guardar Configuración
      </button>
    </div>
  </div>
</AdminLayout>

<style>
  .configuracion-page {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .page-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--neutral-900);
    margin: 0;
  }

  .page-description {
    font-size: 0.875rem;
    color: var(--neutral-500);
    margin: 0.25rem 0 0;
  }

  /* Tabs */
  .config-tabs {
    display: flex;
    gap: 0.5rem;
    background: white;
    padding: 0.5rem;
    border-radius: 12px;
    box-shadow: var(--shadow-card);
    overflow-x: auto;
  }

  .tab-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    border: none;
    border-radius: 8px;
    background: transparent;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--neutral-600);
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .tab-btn:hover {
    background: var(--neutral-100);
    color: var(--neutral-800);
  }

  .tab-btn.active {
    background: var(--color-primary-600);
    color: white;
  }

  /* Config Content */
  .config-content {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .config-section {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .config-section.hidden {
    display: none;
  }

  .section-card {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-card);
    padding: 1.5rem;
  }

  .section-title {
    font-size: 1rem;
    font-weight: 700;
    color: var(--neutral-800);
    margin: 0 0 1.25rem;
  }

  /* Form Grid */
  .form-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  .form-group.full-width {
    grid-column: span 2;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .form-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--neutral-700);
  }

  .form-input,
  .form-select {
    padding: 0.75rem 1rem;
    border: 1px solid var(--neutral-200);
    border-radius: 8px;
    font-size: 0.875rem;
    transition: border-color 0.2s;
  }

  .form-input:focus,
  .form-select:focus {
    outline: none;
    border-color: var(--color-primary-500);
  }

  .form-input.small {
    width: 80px;
    text-align: center;
  }

  /* Settings List */
  .settings-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    background: var(--neutral-50);
    border-radius: 8px;
  }

  .setting-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .setting-name {
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--neutral-800);
  }

  .setting-description {
    font-size: 0.8125rem;
    color: var(--neutral-500);
  }

  /* Toggle Switch */
  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 48px;
    height: 24px;
  }

  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--neutral-300);
    transition: 0.3s;
    border-radius: 24px;
  }

  .toggle-slider::before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: 0.3s;
    border-radius: 50%;
  }

  .toggle-switch input:checked + .toggle-slider {
    background-color: var(--color-primary-600);
  }

  .toggle-switch input:checked + .toggle-slider::before {
    transform: translateX(24px);
  }

  /* Input with suffix */
  .input-with-suffix {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .suffix {
    font-size: 0.875rem;
    color: var(--neutral-500);
  }

  /* Integrations */
  .integrations-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1rem;
  }

  .integration-card {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--neutral-50);
    border: 2px solid var(--neutral-200);
    border-radius: 10px;
    transition: all 0.2s;
  }

  .integration-card.active {
    border-color: var(--success-green-300);
    background: var(--success-green-50);
  }

  .integration-logo {
    width: 48px;
    height: 48px;
    border-radius: 10px;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--neutral-600);
    box-shadow: var(--shadow-sm);
  }

  .integration-card.active .integration-logo {
    color: var(--success-green-600);
  }

  .integration-info {
    flex: 1;
  }

  .integration-name {
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--neutral-800);
    margin: 0;
  }

  .integration-status {
    font-size: 0.75rem;
    font-weight: 500;
  }

  .integration-status.connected {
    color: var(--success-green-600);
  }

  .integration-status.pending {
    color: var(--neutral-500);
  }

  .btn-link {
    background: none;
    border: none;
    font-size: 0.8125rem;
    font-weight: 500;
    color: var(--color-primary-600);
    cursor: pointer;
  }

  .btn-link:hover {
    text-decoration: underline;
  }

  /* Footer */
  .config-footer {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-card);
  }

  .btn-primary,
  .btn-secondary {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-primary {
    background: var(--color-primary-600);
    color: white;
    border: none;
  }

  .btn-primary:hover {
    background: var(--color-primary-700);
  }

  .btn-secondary {
    background: white;
    color: var(--neutral-600);
    border: 1px solid var(--neutral-200);
  }

  .btn-secondary:hover {
    background: var(--neutral-100);
  }

  .mt-4 {
    margin-top: 1rem;
  }

  @media (max-width: 768px) {
    .form-grid {
      grid-template-columns: 1fr;
    }

    .form-group.full-width {
      grid-column: span 1;
    }

    .setting-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }
  }
</style>

<script>
  // Tab switching
  const tabs = document.querySelectorAll<HTMLElement>('.tab-btn');
  const sections = document.querySelectorAll('.config-section');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const targetId = `tab-${tab.dataset.tab}`;
      
      // Update active tab
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      
      // Show target section
      sections.forEach(section => {
        if (section.id === targetId) {
          section.classList.remove('hidden');
        } else {
          section.classList.add('hidden');
        }
      });
    });
  });
</script>

